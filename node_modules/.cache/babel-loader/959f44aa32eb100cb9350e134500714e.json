{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport React from 'react';\nimport { classNames } from \"../../lib/classNames\";\nimport { Icon20Dropdown, Icon24Dropdown } from '@vkontakte/icons';\nimport FormField from \"../FormField/FormField\";\nimport { withAdaptivity, SizeType } from \"../../hoc/withAdaptivity\";\nimport { setRef } from \"../../lib/utils\";\nimport { getClassName } from \"../..\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport Headline from \"../Typography/Headline/Headline\";\nimport Text from \"../Typography/Text/Text\";\nimport { VKCOM } from \"../../lib/platform\";\n\nvar NativeSelect = /*#__PURE__*/function (_React$Component) {\n  _inherits(NativeSelect, _React$Component);\n\n  var _super = _createSuper(NativeSelect);\n\n  function NativeSelect(props) {\n    var _this;\n\n    _classCallCheck(this, NativeSelect);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"isControlledOutside\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"selectEl\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", function (e) {\n      if (!_this.isControlledOutside) {\n        _this.setState({\n          value: e.currentTarget.value\n        });\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setTitle\", function () {\n      var selectedOption = _this.selectEl.options[_this.selectEl.selectedIndex];\n      selectedOption && _this.setState({\n        title: selectedOption.text,\n        notSelected: selectedOption.value === '' && _this.props.hasOwnProperty('placeholder')\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getRef\", function (element) {\n      _this.selectEl = element;\n      setRef(element, _this.props.getRef);\n    });\n\n    var state = {\n      title: '',\n      notSelected: false\n    };\n\n    if (typeof props.value !== 'undefined') {\n      _this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n\n    _this.state = state;\n    return _this;\n  }\n\n  _createClass(NativeSelect, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.value !== this.props.value || prevProps.children !== this.props.children || prevState.value !== this.state.value) {\n        this.setTitle();\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setTitle();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _classNames;\n\n      var _this$props = this.props,\n          style = _this$props.style,\n          value = _this$props.value,\n          defaultValue = _this$props.defaultValue,\n          onChange = _this$props.onChange,\n          align = _this$props.align,\n          placeholder = _this$props.placeholder,\n          children = _this$props.children,\n          className = _this$props.className,\n          getRef = _this$props.getRef,\n          getRootRef = _this$props.getRootRef,\n          disabled = _this$props.disabled,\n          sizeX = _this$props.sizeX,\n          sizeY = _this$props.sizeY,\n          platform = _this$props.platform,\n          restProps = _objectWithoutProperties(_this$props, [\"style\", \"value\", \"defaultValue\", \"onChange\", \"align\", \"placeholder\", \"children\", \"className\", \"getRef\", \"getRootRef\", \"disabled\", \"sizeX\", \"sizeY\", \"platform\"]);\n\n      var TypographyComponent = platform === VKCOM || sizeY === SizeType.COMPACT ? Text : Headline;\n      return createScopedElement(FormField, {\n        Component: \"label\",\n        vkuiClass: classNames(getClassName('Select', platform), (_classNames = {}, _defineProperty(_classNames, 'Select--not-selected', this.state.notSelected), _defineProperty(_classNames, \"Select--align-\".concat(align), !!align), _defineProperty(_classNames, \"Select--sizeX--\".concat(sizeX), !!sizeX), _defineProperty(_classNames, \"Select--sizeY--\".concat(sizeY), !!sizeY), _defineProperty(_classNames, 'Select--disabled', disabled), _classNames)),\n        className: className,\n        style: style,\n        getRootRef: getRootRef\n      }, createScopedElement(\"select\", _extends({}, restProps, {\n        disabled: disabled,\n        vkuiClass: \"Select__el\",\n        onChange: this.onChange,\n        value: this.value,\n        ref: this.getRef\n      }), placeholder && createScopedElement(\"option\", {\n        value: \"\"\n      }, placeholder), children), createScopedElement(TypographyComponent, {\n        weight: \"regular\",\n        vkuiClass: \"Select__container\"\n      }, createScopedElement(\"div\", {\n        vkuiClass: \"Select__title\"\n      }, this.state.title), sizeY === SizeType.COMPACT ? createScopedElement(Icon20Dropdown, null) : createScopedElement(Icon24Dropdown, null)));\n    }\n  }, {\n    key: \"value\",\n    get: function get() {\n      return this.isControlledOutside ? this.props.value : this.state.value;\n    }\n  }]);\n\n  return NativeSelect;\n}(React.Component);\n\nexport default withPlatform(withAdaptivity(NativeSelect, {\n  sizeX: true,\n  sizeY: true\n}));","map":{"version":3,"sources":["../../../src/components/NativeSelect/NativeSelect.tsx"],"names":["NativeSelect","React","Component","state","title","notSelected","props","value","e","selectedOption","prevProps","prevState","setRef","style","defaultValue","onChange","align","placeholder","children","className","getRef","getRootRef","disabled","sizeX","sizeY","platform","restProps","TypographyComponent","SizeType","classNames","getClassName","withPlatform","withAdaptivity"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, ChangeEventHandler, RefCallback, SelectHTMLAttributes } from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { Icon20Dropdown, Icon24Dropdown } from '@vkontakte/icons';\nimport FormField from '../FormField/FormField';\nimport { HasAlign, HasRef, HasRootRef } from '../../types';\nimport { withAdaptivity, AdaptivityProps, SizeType } from '../../hoc/withAdaptivity';\nimport { setRef } from '../../lib/utils';\nimport { getClassName, HasPlatform } from '../..';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport Headline from '../Typography/Headline/Headline';\nimport Text from '../Typography/Text/Text';\nimport { VKCOM } from '../../lib/platform';\n\nexport interface NativeSelectProps extends\n  SelectHTMLAttributes<HTMLSelectElement>,\n  HasRef<HTMLSelectElement>,\n  HasRootRef<HTMLLabelElement>,\n  HasAlign,\n  AdaptivityProps,\n  HasPlatform {\n  defaultValue?: string;\n  placeholder?: string;\n}\n\nexport interface SelectState {\n  value?: string;\n  title?: string;\n  notSelected?: boolean;\n}\n\nclass NativeSelect extends React.Component<NativeSelectProps, SelectState> {\n  constructor(props: NativeSelectProps) {\n    super(props);\n    const state: SelectState = {\n      title: '',\n      notSelected: false,\n    };\n    if (typeof props.value !== 'undefined') {\n      this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n    this.state = state;\n  }\n\n  isControlledOutside?: boolean;\n  selectEl?: HTMLSelectElement;\n\n  onChange: ChangeEventHandler = (e: ChangeEvent<HTMLSelectElement>) => {\n    if (!this.isControlledOutside) {\n      this.setState({ value: e.currentTarget.value });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  };\n\n  setTitle: VoidFunction = () => {\n    const selectedOption = this.selectEl.options[this.selectEl.selectedIndex];\n    selectedOption && this.setState({\n      title: selectedOption.text,\n      notSelected: selectedOption.value === '' && this.props.hasOwnProperty('placeholder'),\n    });\n  };\n\n  componentDidUpdate(prevProps: NativeSelectProps, prevState: SelectState) {\n    if (\n      prevProps.value !== this.props.value ||\n      prevProps.children !== this.props.children ||\n      prevState.value !== this.state.value\n    ) {\n      this.setTitle();\n    }\n  }\n\n  componentDidMount() {\n    this.setTitle();\n  }\n\n  get value() {\n    return this.isControlledOutside ? this.props.value : this.state.value;\n  }\n\n  getRef: RefCallback<HTMLSelectElement> = (element) => {\n    this.selectEl = element;\n    setRef(element, this.props.getRef);\n  };\n\n  render() {\n    const { style, value, defaultValue, onChange, align, placeholder, children, className,\n      getRef, getRootRef, disabled, sizeX, sizeY, platform, ...restProps } = this.props;\n\n    const TypographyComponent = platform === VKCOM || sizeY === SizeType.COMPACT ? Text : Headline;\n\n    return (\n      <FormField\n        Component=\"label\"\n        vkuiClass={classNames(getClassName('Select', platform), {\n          ['Select--not-selected']: this.state.notSelected,\n          [`Select--align-${align}`]: !!align,\n          [`Select--sizeX--${sizeX}`]: !!sizeX,\n          [`Select--sizeY--${sizeY}`]: !!sizeY,\n          'Select--disabled': disabled,\n        })}\n        className={className}\n        style={style}\n        getRootRef={getRootRef}\n      >\n        <select\n          {...restProps}\n          disabled={disabled}\n          vkuiClass=\"Select__el\"\n          onChange={this.onChange}\n          value={this.value}\n          ref={this.getRef}\n        >\n          {placeholder && <option value=\"\">{placeholder}</option>}\n          {children}\n        </select>\n        <TypographyComponent weight=\"regular\" vkuiClass=\"Select__container\">\n          <div vkuiClass=\"Select__title\">{this.state.title}</div>\n          {sizeY === SizeType.COMPACT ? <Icon20Dropdown /> : <Icon24Dropdown />}\n        </TypographyComponent>\n      </FormField>\n    );\n  }\n}\n\nexport default withPlatform(withAdaptivity(NativeSelect, {\n  sizeX: true,\n  sizeY: true,\n}));\n"]},"metadata":{},"sourceType":"module"}