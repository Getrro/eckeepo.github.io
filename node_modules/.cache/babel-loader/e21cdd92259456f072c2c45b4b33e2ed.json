{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { classNames } from \"../../lib/classNames\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { withAdaptivity } from \"../../hoc/withAdaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from \"../IconButton/IconButton\";\nexport var Removable = withAdaptivity(function (props) {\n  var children = props.children,\n      sizeY = props.sizeY,\n      onRemove = props.onRemove,\n      removePlaceholder = props.removePlaceholder,\n      align = props.align,\n      restProps = _objectWithoutProperties(props, [\"children\", \"sizeY\", \"onRemove\", \"removePlaceholder\", \"align\"]);\n\n  var platform = usePlatform();\n\n  var _useDOM = useDOM(),\n      document = _useDOM.document;\n\n  var removeButtonRef = useRef(null);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isRemoveActivated = _useState2[0],\n      setRemoveActivated = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      removeOffset = _useState4[0],\n      updateRemoveOffset = _useState4[1];\n\n  var deactivateRemove = useCallback(function () {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n    document.removeEventListener('click', deactivateRemove);\n  }, [setRemoveActivated, updateRemoveOffset]);\n\n  var onRemoveActivateClick = function onRemoveActivateClick(e) {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n    document.addEventListener('click', deactivateRemove);\n  };\n\n  var onRemoveClick = function onRemoveClick(e) {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  useEffect(function () {\n    if (isRemoveActivated && (removeButtonRef === null || removeButtonRef === void 0 ? void 0 : removeButtonRef.current)) {\n      updateRemoveOffset(removeButtonRef.current.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n  useEffect(function () {\n    return function () {\n      document.removeEventListener('click', deactivateRemove);\n    };\n  }, [deactivateRemove]);\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(getClassName('Removable', platform), \"Removable--\".concat(align), \"Removable--sizeY-\".concat(sizeY))\n  }), createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\",\n    style: platform === IOS ? {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    } : null\n  }, children, (platform === ANDROID || platform === VKCOM) && createScopedElement(IconButton, {\n    vkuiClass: \"Removable__control Removable__remove\",\n    onClick: onRemoveClick\n  }, createScopedElement(Icon24Cancel, null)), platform === IOS && createScopedElement(\"button\", {\n    vkuiClass: \"Removable__control Removable__indicator\",\n    onClick: onRemoveActivateClick\n  }, createScopedElement(\"i\", {\n    vkuiClass: \"Removable__indicator-in\"\n  }))), platform === IOS && createScopedElement(\"button\", {\n    ref: removeButtonRef,\n    vkuiClass: \"Removable__remove\",\n    onClick: onRemoveClick,\n    style: {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    }\n  }, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__remove-in\"\n  }, removePlaceholder)));\n}, {\n  sizeY: true\n});\nRemovable.defaultProps = {\n  align: 'center',\n  removePlaceholder: 'Удалить'\n};","map":{"version":3,"sources":["../../../src/components/Removable/Removable.tsx"],"names":["Removable","withAdaptivity","children","sizeY","onRemove","removePlaceholder","align","restProps","props","platform","usePlatform","document","useDOM","removeButtonRef","useRef","isRemoveActivated","setRemoveActivated","useState","removeOffset","updateRemoveOffset","deactivateRemove","useCallback","onRemoveActivateClick","e","onRemoveClick","useEffect","classNames","getClassName","transform"],"mappings":"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","sourcesContent":["import { AllHTMLAttributes, FC, ReactNode, MouseEvent, useCallback, useEffect, useRef, useState } from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { getClassName } from '../../helpers/getClassName';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { ANDROID, IOS, VKCOM } from '../../lib/platform';\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from '../IconButton/IconButton';\n\nexport interface RemovePlaceholderProps {\n  /**\n   * iOS only. Текст в выезжающей кнопке для удаления ячейки.\n   */\n  removePlaceholder?: ReactNode;\n}\n\ninterface RemovableProps extends AllHTMLAttributes<HTMLElement>, RemovePlaceholderProps {\n  /**\n   * Расположение кнопки удаления.\n   */\n  align?: 'start' | 'center';\n  onRemove?: (e: MouseEvent) => void;\n}\n\nexport const Removable: FC<RemovableProps> = withAdaptivity((props: RemovableProps & Pick<AdaptivityProps, 'sizeY'>) => {\n  const {\n    children,\n    sizeY,\n    onRemove,\n    removePlaceholder,\n    align,\n    ...restProps\n  } = props;\n  const platform = usePlatform();\n  const { document } = useDOM();\n\n  const removeButtonRef = useRef(null);\n\n  const [isRemoveActivated, setRemoveActivated] = useState(false);\n  const [removeOffset, updateRemoveOffset] = useState(0);\n\n  const deactivateRemove = useCallback(() => {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n\n    document.removeEventListener('click', deactivateRemove);\n  }, [setRemoveActivated, updateRemoveOffset]);\n\n  const onRemoveActivateClick = (e: MouseEvent) => {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n\n    document.addEventListener('click', deactivateRemove);\n  };\n\n  const onRemoveClick = (e: MouseEvent) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  useEffect(() => {\n    if (isRemoveActivated && removeButtonRef?.current) {\n      updateRemoveOffset(removeButtonRef.current.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n\n  useEffect(() => {\n    return () => {\n      document.removeEventListener('click', deactivateRemove);\n    };\n  }, [deactivateRemove]);\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName('Removable', platform),\n        `Removable--${align}`,\n        `Removable--sizeY-${sizeY}`,\n      )}\n    >\n      <div vkuiClass=\"Removable__content\" style={platform === IOS ? { transform: `translateX(-${removeOffset}px)` } : null}>\n        {children}\n\n        {(platform === ANDROID || platform === VKCOM) &&\n          <IconButton vkuiClass=\"Removable__control Removable__remove\" onClick={onRemoveClick}>\n            <Icon24Cancel />\n          </IconButton>\n        }\n        {platform === IOS && (\n          <button vkuiClass=\"Removable__control Removable__indicator\" onClick={onRemoveActivateClick}>\n            <i vkuiClass=\"Removable__indicator-in\" />\n          </button>\n        )}\n      </div>\n\n      {platform === IOS &&\n        <button\n          ref={removeButtonRef}\n          vkuiClass=\"Removable__remove\"\n          onClick={onRemoveClick}\n          style={{ transform: `translateX(-${removeOffset}px)` }}\n        >\n          <span vkuiClass=\"Removable__remove-in\">{removePlaceholder}</span>\n        </button>\n      }\n    </div>\n  );\n}, {\n  sizeY: true,\n});\n\nRemovable.defaultProps = {\n  align: 'center',\n  removePlaceholder: 'Удалить',\n};\n"]},"metadata":{},"sourceType":"module"}